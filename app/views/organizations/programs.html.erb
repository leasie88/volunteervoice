<%= javascript_include_tag "/assets/jquery.js"%>

	<div class="container" style="padding-bottom:250px;">
	    <div class="row">

			<div style="padding-bottom:20px;float:right; margin-right:125px; margin-top:25px" class="three columns">
	            <ul class="tab">
					<li><a href="/organizations/<%= @organization.id%>"><img src="https://s3-us-west-1.amazonaws.com/volunteervoice/images/tabProfileNo.png" style="width:125px;"></a></li>
					<li><a href="/organizations/<%= @organization.id%>/programs"><img src="https://s3-us-west-1.amazonaws.com/volunteervoice/images/tabProgramsYes.png" style="width:125px; margin-top:-75px; margin-left:140px"></a></li>
	            </ul>
	        </div>
	<div style="position:absolute; top:230px">
	<img src="https://s3-us-west-1.amazonaws.com/volunteervoice/images/FlagProgramBlurb.png" /></div>
	<div class="row" style="margin-top:100px; border:1px solid #575758; background-color:#E9ECE9;padding-bottom:10px; width:99%">

		<% @countries = Hash.new %>
		<% @progs = @organization.programs%>
		<% @progs = @progs.sort_by{|p| THECOUNTRIES2[p.location].downcase} %>
		<% @progs.each do |f| %>
		<% if !(@countries.has_key?(f.location))%>
		<% @countries[f.location] = 1%>
		<% else %>
		<% @countries[f.location] = @countries[f.location] + 1%>
		<% end %>
		<% end %>
<div class="twelve columns" align="center" style="margin:auto">
<% @countries.keys.each do |f|%>
<div class="two columns" style="width:145px; padding:0; margin:0; margin-top:10px; margin-bottom:30px">
	<p><a href="#programs-box<%=f%>" class="programs-window" style="font-family:museoSlab500Regular"><%= THECOUNTRIES[f]%></a></p>
<a href="#programs-box<%=f%>" class="programs-window"><%= image_tag "https://s3-us-west-1.amazonaws.com/volunteervoice/images/flags/#{THECOUNTRIES2[f]}.png", :style => "height:50px; width:100px;"%></a>
</div>



<div id="programs-box<%=f%>" class="programs-popup">
	<a href="#" class="close"><div class="close_image"></div></a>
	<table style="border-left:1px solid #575758;border-right:1px solid #575758;border-top:1px solid #575758;">
	<% @organization.programs.each do |p|%>
	<% if p.location == f%>
	<tr style="background-color:#D9DEDA;border-bottom:1px solid #575758;">
		<td style="width:500px"><a href="/programs/<%=p.id%>" style="font-size:1.5em" class="red-link"><%=p.name%></a><br /><%= p.truncated_description100.html_safe%></td>
		<td style="width:130px"><%= render :partial => "star", :locals => {:star => p.overall}%></td>
	</tr>
	</div>
	<% end %>
	<% end %>
	</table>
</div>
<% end %>
</div>
</div>
</div>
</div>
</div>



<style type="text/css">
   
    ul.tab
    {
        list-style: none;
        margin: 0;
        padding: 0;
		float: right;
    }
    ul.tab li
    {
        display: inline;
        padding: 10px;
        color: #575758;
        cursor: pointer;
    }


	.programs-popup{
		display:none;
		background: #E3E6D5;
		padding: 10px; 	
		border: 2px solid #575758;
		float: left;
		color: #575758;
		position: fixed;
		width: 650px;
		height:auto;
		max-height:300px;
		overflow:auto;
		top: 50%; left: 50%;
		z-index: 55;
		box-shadow: 0px 0px 20px #999; /* CSS3 */
	        -moz-box-shadow: 0px 0px 20px #999; /* Firefox */
	        -webkit-box-shadow: 0px 0px 20px #999; /* Safari, Chrome */
		border-radius:3px 3px 3px 3px;
	        -moz-border-radius: 3px; /* Firefox */
	        -webkit-border-radius: 3px; /* Safari, Chrome */
	}
	
	a.programs-window:link{color:#575758}
	a.programs-window:visited{color:#575758}
	a.programs-window:active{color:#575758}
	a.programs-window:hover{color:#68c2d8}
	
	a.red-link:link{color:#e67b5a}
	a.red-link:active{color:#e67b5a}
	a.red-link:visited{color:#e67b5a}
	a.red-link:hover{color:white}
</style>

<script type="text/javascript">
	$(document).ready(function() {
		$('a.programs-window').click(function() {

		            //Getting the variable's value from a link 
			var programsBox = $(this).attr('href');

			//Fade in the Popup
			$(programsBox).fadeIn(300);

			//Set the center alignment padding + border see css style
			var popMargTop = ($(programsBox).height() + 24) / 2; 
			var popMargLeft = ($(programsBox).width() + 24) / 2; 

			$(programsBox).css({ 
				'margin-top' : -popMargTop,
				'margin-left' : -popMargLeft
			});

			// Add the mask to body
			$('body').append('<div id="mask" style="display:block; opacity:.5;filter: alpha(opacity=50);"></div>');
			$('#mask').fadeIn(300);

			return false;
		});

		// When clicking on the button close or the mask layer the popup closed
		$('a.close, #mask').live('click', function() { 
		  $('#mask , .programs-popup').fadeOut(300 , function() {
			$('#mask').remove();  
		}); 
		return false;
		});
	});
</script>

